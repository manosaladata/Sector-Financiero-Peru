layout.show(c(2))
#a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
#layout(a)
layout.show(c(1:2))
#a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
#layout(a)
layout.show(c(1,2))
#a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
#layout(a)
layout.show(c(1:2))
#a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
#layout(a)
layout.show(c(2))
a<-matrix(c(6:2), nrow = 2, byrow = FALSE)
a<-matrix(c(1:6), nrow = 2, byrow = FALSE)
layout(a)
layout.show(c(2))
layout.show(c(6))
a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
layout(a)
layout.show(c(2))
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA_Ret, main = "RETORNOS DE TESLA")
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
x11()
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA_Ret, main = "RETORNOS DE TESLA")
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
1
dev.off()
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA_Ret, main = "RETORNOS DE TESLA")
dev.off()
dev.off()
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
dev.off()
dev.off()
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA_Ret, main = "RETORNOS DE TESLA")
chartSeries(TSLA, theme = "white")
a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
layout(a)
layout.show(c(2))
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA_Ret, main = "RETORNOS DE TESLA")
dev.off()
View(TSLA)
dev.off()
a<-matrix(c(1:2), nrow = 2, byrow = FALSE)
layout(a)
layout.show(c(2))
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "TESLA")
chart.TimeSeries(TSLA_Ret, main = "RETORNOS DE TESLA")
dev.off()
hist(TSLA_Ret)
qqplot(TSLA_Ret)
hist(TSLA_Ret)
qqnorm(TSLA_Ret)
hist(TSLA$TSLA.Close)
x11()
hist(TSLA$TSLA.Close)
X11()
qqnorm(TSLA$TSLA.Close)
x11()
hist(TSLA_Ret)
x11()
qqnorm(TSLA_Ret)
x11()
hist(TSLA$TSLA.Close, main = "Precios TESLA")
X11()
qqnorm(TSLA$TSLA.Close, main = "Precios TESLA")
x11()
hist(TSLA_Ret, main = "Retornos TESLA")
x11()
qqnorm(TSLA_Ret, main = "Retornos TESLA")
library(readr)
Datos_históricos_TSLA_2_ <- read_csv("C:/Users/Jose/Downloads/Datos históricos TSLA (2).csv")
View(Datos_históricos_TSLA_2_)
View(Datos_históricos_TSLA_2_)
Base_Datos <- Datos_históricos_TSLA_2_
View(Base_Datos)
TSLA <- Datos_históricos_TSLA_2_
View(TSLA)
plot(TSLA$Último)
plot(TSLA$Último)
library(readr)
Datos_histÃ³ricos_TSLA_2_ <- read_csv("C:/Users/Jose/Downloads/Datos históricos TSLA (2).csv",
col_types = cols(Fecha = col_date(format = "%d/%m/%Y")))
View(Datos_histÃ³ricos_TSLA_2_)
library(readr)
Datos_histÃ�_�_Ã_�_³ricos_TSLA_2_ <- read_csv("C:/Users/Jose/Downloads/Datos históricos TSLA (2).csv",
col_types = cols(Fecha = col_date(format = "%d.%m.%Y")))
View(Datos_histÃ�_�_Ã_�_³ricos_TSLA_2_)
library(readr)
Datos_histÃ³ricos_TSLA_2_ <- read_csv("C:/Users/Jose/Downloads/Datos históricos TSLA (2).csv",
col_types = cols(Fecha = col_date(format = "%m/%d/%Y")))
View(Datos_histÃ³ricos_TSLA_2_)
library(readr)
Datos_histÃ�_�_³ricos_TSLA_2_ <- read_csv("C:/Users/Jose/Downloads/Datos históricos TSLA (2).csv",
col_types = cols(Fecha = col_date(format = "%d.%m.%Y")))
View(Datos_histÃ�_�_³ricos_TSLA_2_)
View(Base_Datos)
class(`Datos_histÃ³ricos_TSLA_2_`)
class(`Datos_histÃ³ricos_TSLA_2_`$Fecha)
#CAMBIANDO EL NOMBRE DE LA BASE DE DATOS
TSLA <-Datos_histÃ³ricos_TSLA_2_
View(TSLA)
library(readr)
Datos_histÃ³ricos_TSLA_2_ <- read_csv("C:/Users/Jose/Downloads/Datos históricos TSLA (2).csv",
col_types = cols(Fecha = col_date(format = "%d.%m.%Y")))
View(Datos_histÃ³ricos_TSLA_2_)
#CAMBIANDO EL NOMBRE DE LA BASE DE DATOS
TSLA <-Datos_histÃ³ricos_TSLA_2_
View(TSLA)
plot(TSLA$Último)
plot(TSLA$Último)
plot(TSLA$Último, decompose())
TSLA<-data.frame(TSLA)
plot(TSLA$Último, d)
plot(TSLA$Último)
View(TSLA)
plot(TSLA$Último, y = TSLA$Fecha)
plot(data(TSLA), x = TSLA$Fecha, y = TSLA$Último)
plot(data(TSLA), y = TSLA$Último)
plot(data=TSLA, x = TSLA$Fecha, y = TSLA$Último)
plot(data=TSLA, x = TSLA$Fecha, y = TSLA$Último, type = "l")
#quantmod
library(quantmod)
#PerformanceAnalytics
library(PerformanceAnalytics)
getSymbols.yahoo('TSLA', env = globalenv(), return.class = "xts",
from = '2020-01-01',to = Sys.Date(), periodicity = 'daily')
TSLA_1 <-Datos_histÃ³ricos_TSLA_2_
TSLA<-data.frame(TSLA_1)
plot(data=TSLA_1, x = TSLA_1$Fecha, y = TSLA_1$Último, type = "l")
plot(data=TSLA_1, x = TSLA_1$Fecha, y = TSLA_1$Último, type = "l", xlab = "Fecha",
ylab = "Precio")
getSymbols.yahoo('TSLA', env = globalenv(), return.class = "xts",
from = '2020-01-01',to = Sys.Date(), periodicity = 'daily')
View(TSLA)
getSymbols.yahoo('TSLA', env = globalenv(), return.class = "xts",
from = '2000-01-01',to = Sys.Date(), periodicity = 'daily')
View(TSLA)
library(readr)
TSLA <- read_csv("C:/Users/Jose/Downloads/TSLA.csv",
col_types = cols(Date = col_date(format = "%Y-%m-%d")))
View(TSLA)
# IMPORTAR LA BASE DE DATOS
library(readr)
TSLA_1 <- read_csv("C:/Users/Jose/Downloads/TSLA.csv",
col_types = cols(Date = col_date(format = "%Y-%m-%d")))
View(TSLA_1)
plot(data=TSLA_1, x = TSLA_1$Fecha, y = TSLA_1$Último, type = "l", xlab = "Fecha",
ylab = "Precio")
plot(TSLA_1$Close)
plot(TSLA_1$Close, type = "l", xlab = "Fecha",ylab = "Precio TSLA")
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio TSLA")
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio")
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio de la Acicon")
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio TSLA")
TSLA_1 <- read_csv("C:/Users/Jose/Downloads/TSLA.csv",
col_types = cols(Date = col_date(format = "%Y-%m-%d")))
#GRAFICO SIMPLE RUDIMENTARIO
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio TSLA")
#GRAFICO SIMPLE RUDIMENTARIO
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio TSLA")
getSymbols.yahoo('TSLA', env = globalenv(), return.class = "xts",
from = '2000-01-01',to = Sys.Date(), periodicity = 'daily')
View(TSLA)
chartSeries(TSLA, theme = "white")
x11()
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio TSLA")
x11()
chartSeries(TSLA, theme = "white")
chartSeries(TSLA, type = "candlesticks",
theme = "white",
TA='addBBands(); addBBands(draw="p"); addVo(); addMACD(); addRSI(); addSMA()',
subset = 'last 50 weeks')
chartSeries(TSLA, type = "candlesticks",
theme = "white",
TA='addBBands(); addVo(); addMACD(); addSMA()',
subset = 'last 50 weeks')
chartSeries(TSLA, type = "line",
theme = "white",
TA='addBBands(); addVo(); addMACD(); addSMA()',
subset = 'last 50 weeks')
chartSeries(TSLA, type = "line",
theme = "white",
TA='addBBands(); addVo(); addMACD()',
subset = 'last 50 weeks')
chartSeries(TSLA, type = "line",
theme = "white",
TA='addBBands(); addVo(); addMACD(); addSMA()')
#PerformanceAnalytics
library(PerformanceAnalytics)
chart.TimeSeries(TSLA$TSLA.Adjusted, main = "APPLE")
x11()
plot(TSLA_1$Close, type = "l", xlab = "Fecha", ylab = "Precio TSLA")
TSLA_Ret = Return.calculate(TSLA$TSLA.Adjusted, method = "compound")
View(TSLA_Ret)
TSLA_Ret = TSLA_Ret[-1,]
View(TSLA_Ret)
chart.TimeSeries(TSLA_Ret, main="Retornos de TESLA")
chartSeries(TSLA, type = "line",
theme = "white",
TA='addBBands(); addVo(); addMACD(); addSMA(); addReturn',
subset = 'last 50 weeks')
x11()
hist(TSLA$TSLA.Close, main = "Precios TESLA")
X11()
qqnorm(TSLA$TSLA.Close, main = "Precios TESLA")
x11()
qqnorm(TSLA_Ret, main = "Retornos TESLA")
x11()
hist(TSLA_Ret, main = "Precios TESLA"
hist(TSLA_Ret, main = "Precios TESLA"
hist(TSLA_Ret, main = "Retornos TESLA"
x11()
hist(TSLA_Ret, main = "Retornos TESLA"
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA"
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA"
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA"
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
x11()
qqnorm(TSLA_Ret, main = "Retornos TESLA")
x11()
hist(TSLA_Ret, main = "Retornos TESLA")
qqline(my_data$len, col = "steelblue", lwd = 2)
qqline(TSLA_Ret, col = "steelblue", lwd = 2)
qqline(TSLA_Ret, lwd = 2)
qqline(TSLA_Ret)
qqline(TSLA_Ret$TSLA.Adjusted)
qqnorm(TSLA_Ret, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
qqnorm(TSLA_Ret, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
qqnorm(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
X11()
qqnorm(TSLA$TSLA.Close, main = "Precios TESLA")
qqline(TSLA$TSLA.Close)
getSymbols.yahoo('TSLA', env = globalenv(), return.class = "xts",
from = '2000-01-01',to = Sys.Date(), periodicity = 'daily')
chartSeries(TSLA, type = "candlesticks",
theme = "white",
TA='addBBands(); addVo(); addMACD(); addSMA()',
subset = 'last 50 weeks')
library(readr)
TSLA <- read_csv("C:/Users/Jose/Downloads/TSLA.csv",
col_types = cols(Date = col_date(format = "%Y-%m-%d")))
View(TSLA)
View(TSLA)
library(readr)
TSLA_1 <- read_csv("C:/Users/Jose/Downloads/TSLA.csv",
col_types = cols(Date = col_date(format = "%Y-%m-%d")))
View(TSLA_1)
plot(TSLA_1)
plot(TSLA_1$`Adj Close`)
plot(TSLA_1$`Adj Close`, type = "l")
plot(TSLA_1$`Adj Close`)
plot(TSLA_1$`Adj Close`)
plot(TSLA_1$`Adj Close`)
plot(TSLA_1$`Adj Close`)
plot(TSLA_1$`Adj Close`,type = "l")
plot(TSLA_1$`Adj Close`)
plot(TSLA_1$`Adj Close`, type = "l", xlab = "Fecha", ylab = "Precio TESLA")
library(quantmod)
getSymbols.yahoo('TSLA', env = goblalenv(),
return.class = "xts",
from = '2000-01-01', to = Sys.Date(),
periodicity = 'daily')
getSymbols.yahoo('TSLA', env = globalenv(),
return.class = "xts",
from = '2000-01-01', to = Sys.Date(),
periodicity = 'daily')
View(TSLA)
chartSeries(TSLA, theme = "white")
x11()
plot(TSLA_1$`Adj Close`, type = "l", xlab = "Fecha", ylab = "Precio TESLA")
x11()
chartSeries(TSLA, theme = "white")
x11()
chartSeries(TSLA, theme = "white",
TA = 'addBBands(); addVo(); addMACD(); addSMA()',
subset = 'last 50 weeks')
x11()
chartSeries(TSLA, theme = "white")
x11()
chartSeries(TSLA, theme = "white",
TA = 'addBBands(); addVo(); addMACD(); addSMA()',
subset = 'last 50 weeks')
x11()
chartSeries(TSLA, theme = "white",
TA = 'addBBands()',
subset = 'last 50 weeks')
#install.packages("PerformanceAnalytics")
library(PerformanceAnalytics)
chart.TimeSeries(TSLA$TSLA.Adjusted)
chart.TimeSeries(TSLA$TSLA.Adjusted)
TSLA_Ret = Return.calculate(TSLA$TSLA.Adjusted, method = "compound")
View(TSLA_Ret)
TSLA_Ret<-TSLA_Ret[-1,]
View(TSLA_Ret)
chart.TimeSeries(TSLA_Ret$TSLA.Adjusted, main = "RETORNOS TESLA")
x11()
hist(TSLA$TSLA.Adjusted, main = "Precios TESLA")
X11()
qqnorm(TSLA$TSLA.Adjusted, main = "Precios TESLA")
qqline(TSLA$TSLA.Adjusted)
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
x11()
qqnorm(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
hist(TSLA$TSLA.Adjusted, main = "Precios TESLA")
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
X11()
qqnorm(TSLA$TSLA.Adjusted, main = "Precios TESLA")
qqline(TSLA$TSLA.Adjusted)
x11()
qqnorm(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
x11()
qqnorm(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
hist(TSLA$TSLA.Adjusted, main = "Precios TESLA")
X11()
qqnorm(TSLA$TSLA.Adjusted, main = "Precios TESLA")
qqline(TSLA$TSLA.Adjusted)
x11()
hist(TSLA$TSLA.Adjusted, main = "Precios TESLA")
X11()
qqnorm(TSLA$TSLA.Adjusted, main = "Precios TESLA")
qqline(TSLA$TSLA.Adjusted)
#ESTACIONARIEDAD E(X)=0
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
x11()
qqnorm(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
x11()
hist(TSLA$TSLA.Adjusted, main = "Precios TESLA")
X11()
qqnorm(TSLA$TSLA.Adjusted, main = "Precios TESLA")
qqline(TSLA$TSLA.Adjusted)
#ESTACIONARIEDAD E(X)=0
x11()
hist(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
x11()
qqnorm(TSLA_Ret$TSLA.Adjusted, main = "Retornos TESLA")
qqline(TSLA_Ret$TSLA.Adjusted)
# AUTHOR: JÓSE CONDE GÁLVEZ (ASISTENTE DE CÁTEDRA)
#######################################################################################
################################# FINANZAS APLICADAS EN RSTUDIO #######################
#######################################################################################
#install.packages("readr")
library(readr)
TSLA_1 <- read_csv("C:/Users/Jose/Downloads/TSLA.csv",
col_types = cols(Date = col_date(format = "%Y-%m-%d")))
View(TSLA_1)
x11()
plot(TSLA_1$`Adj Close`, type = "l", xlab = "Fecha", ylab = "Precio TESLA")
library(openxlsx)
datos <- read.xlsx("C:/Users/Jose/Downloads/quierosercientificodedatos.xlx")
datos <- read.xlsx("C:/Users/Jose/Downloads/quierosercientificodedatos.xlsx")
View(datos)
View(datos)
View(datos)
datos <- read.xlsx("C:/Users/Jose/Downloads/quierosercientificodedatos.xlsx", detectDates = T)
View(datos)
class(datos)
class(datos$PERIODO)
class(datos$M)
View(datos)
rnorm(n, mean=0, sd=1)
rnorm(TSLA, mean=0, sd=1)
plot(rnorm(TSLA, mean=0, sd=1))
rexp(TSLA, rate=1)
plot(rexp(TSLA, rate=1))
plot(rnorm(TSLA_Ret, mean=0, sd=1))
plot(rexp(TSLA_Ret, rate=1))
plot(rnorm(TSLA_Ret))
rlogis(TSLA_Ret)
plot(rlogis(TSLA_Ret))
getwd()
imp.data.xlsx<-function(mes, anio, pestania, dia, skips){
mes_num<-as.data.frame(cbind(c("en","fe","ma","ab","my","jn","jl","ag","se","oc","no","di"),c(1:12)))
names(mes_num)<-c("mes","numero")
mes_num = mes_num[(mes_num$mes %in% mes),2]
archivo = paste("B-2401-",mes,anio,".xls",sep="")
a<-readxl::read_xlsx(path=archivo, sheet = pestania, skip = skips)
a<-a[,-10]
a<-a[!is.na(a[,2]),]
b<-a[1,-1]
a<-a[-1,]
names(a)<-c("Indicadores",b)
exc = !names(a) %in% "Indicadores"
a[,exc] = sapply(a[,exc], function(x) round(as.numeric(as.character(x)), 2))
a <- a%>%tidyr::gather(Bancos,valores,-Indicadores)
data.final<- a%>%tidyr::spread(Indicadores,valores)
fecha=as.Date(paste(anio,"-",mes_num,"-",dia,sep=""))
fecha<-as.Date(fecha)
data.final$Periodo= fecha
}
imp.data.xls<-function(mes, anio, pestania, dia, skips){
mes_num<-as.data.frame(cbind(c("en","fe","ma","ab","my","jn","jl","ag","se","oc","no","di"),c(1:12)))
names(mes_num)<-c("mes","numero")
mes_num = mes_num[(mes_num$mes %in% mes),2]
archivo = paste("B-2401-",mes,anio,".xls",sep="")
a<-readxl::read_xls(path=archivo, sheet = pestania, skip = skips)
a<-a[,-10]
a<-a[!is.na(a[,2]),]
b<-a[1,-1]
a<-a[-1,]
names(a)<-c("Indicadores",b)
exc = !names(a) %in% "Indicadores"
a[,exc] = sapply(a[,exc], function(x) round(as.numeric(as.character(x)), 2))
a <- a%>%tidyr::gather(Bancos,valores,-Indicadores)
data.final<- a%>%tidyr::spread(Indicadores,valores)
fecha=as.Date(paste(anio,"-",mes_num,"-",dia,sep=""))
fecha<-as.Date(fecha)
data.final$Periodo= fecha
data.final
}
di2016<-imp.data.xlsx(dia = "31",mes = "di",anio="2016", pestania = 1, skips = 0)
#AÑO 2016
setwd("C:/Users/Jose/Desktop/Universidad/Manos a la Data/Investigacion/data/raw data/Indicadores_Financieros/2016")
di2016<-imp.data.xlsx(dia = "31",mes = "di",anio="2016", pestania = 1, skips = 0)
library(readxl)
library(dplyr)
library(tidyr)
imp.data.xlsx<-function(mes, anio, pestania, dia, skips){
mes_num<-as.data.frame(cbind(c("en","fe","ma","ab","my","jn","jl","ag","se","oc","no","di"),c(1:12)))
names(mes_num)<-c("mes","numero")
mes_num = mes_num[(mes_num$mes %in% mes),2]
archivo = paste("B-2401-",mes,anio,".xls",sep="")
a<-readxl::read_xlsx(path=archivo, sheet = pestania, skip = skips)
a<-a[,-10]
a<-a[!is.na(a[,2]),]
b<-a[1,-1]
a<-a[-1,]
names(a)<-c("Indicadores",b)
exc = !names(a) %in% "Indicadores"
a[,exc] = sapply(a[,exc], function(x) round(as.numeric(as.character(x)), 2))
a <- a%>%tidyr::gather(Bancos,valores,-Indicadores)
data.final<- a%>%tidyr::spread(Indicadores,valores)
fecha=as.Date(paste(anio,"-",mes_num,"-",dia,sep=""))
fecha<-as.Date(fecha)
data.final$Periodo= fecha
}
imp.data.xls<-function(mes, anio, pestania, dia, skips){
mes_num<-as.data.frame(cbind(c("en","fe","ma","ab","my","jn","jl","ag","se","oc","no","di"),c(1:12)))
names(mes_num)<-c("mes","numero")
mes_num = mes_num[(mes_num$mes %in% mes),2]
archivo = paste("B-2401-",mes,anio,".xls",sep="")
a<-readxl::read_xls(path=archivo, sheet = pestania, skip = skips)
a<-a[,-10]
a<-a[!is.na(a[,2]),]
b<-a[1,-1]
a<-a[-1,]
names(a)<-c("Indicadores",b)
exc = !names(a) %in% "Indicadores"
a[,exc] = sapply(a[,exc], function(x) round(as.numeric(as.character(x)), 2))
a <- a%>%tidyr::gather(Bancos,valores,-Indicadores)
data.final<- a%>%tidyr::spread(Indicadores,valores)
fecha=as.Date(paste(anio,"-",mes_num,"-",dia,sep=""))
fecha<-as.Date(fecha)
data.final$Periodo= fecha
data.final
}
#AÑO 2016
setwd("C:/Users/Jose/Desktop/Universidad/Manos a la Data/Investigacion/data/raw data/Indicadores_Financieros/2016")
di2016<-imp.data.xlsx(dia = "31",mes = "di",anio="2016", pestania = 1, skips = 0)
View(di2016)
imp.data.xls<-function(mes, anio, pestania, dia, skips){
mes_num<-as.data.frame(cbind(c("en","fe","ma","ab","my","jn","jl","ag","se","oc","no","di"),c(1:12)))
names(mes_num)<-c("mes","numero")
mes_num = mes_num[(mes_num$mes %in% mes),2]
archivo = paste("B-2401-",mes,anio,".xls",sep="")
a<-readxl::read_xls(path=archivo, sheet=pestania, skip=skips)
a<-a[,-10]
a<-a[!is.na(a[,2]),]
b<-a[1,-1]
a<-a[-1,]
names(a)<-c("Indicadores",b)
exc = !names(a) %in% "Indicadores"
a[,exc] = sapply(a[,exc], function(x) round(as.numeric(as.character(x)), 2))
a <- a%>%tidyr::gather(Bancos,valores,-Indicadores)
data.final<- a%>%tidyr::spread(Indicadores,valores)
fecha=as.Date(paste(anio,"-",mes_num,"-",dia,sep=""))
fecha<-as.Date(fecha)
data.final$Periodo= fecha
data.final
}
